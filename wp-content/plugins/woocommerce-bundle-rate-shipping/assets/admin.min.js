/*!  2.0.3 2016-08-26 14:08 */
var ENDA_BUNDLERATE={};!function(a){ENDA_BUNDLERATE.updateLayerNames=function(b){var c=0,d=b.find("tr.rate_row");d.each(function(){a(this).find("input").each(function(){var b=a(this).attr("name").replace(/rates\]\[\d+\]/,"rates]["+c+"]");a(this).attr("name",b)}),c+=1})},ENDA_BUNDLERATE.updateStartCount=function(a){var b,c=a.parents("tr.rate_row").first(),d=c.next();b=a.hasClass("remove_bundle_layer")?parseInt(c.prev().find("input").first().val())+1:parseInt(a.val())+1,d.find("span.start_count").first().text(b)},ENDA_BUNDLERATE.toggleSpecificCountries=function(a){"specific"===a.val()?a.parent().next("div").show():a.parent().next("div").hide()},ENDA_BUNDLERATE.addLayer=function(b){if("disabled"===b.attr("disabled"))return!1;var c=this,d=b.parents("table").first(),e=d.find("tbody tr.rate_row").last(),f={action:"get_new_layer",start_count:parseInt(e.prev().find("input").first().val())+1,cost_input:e.find("input").last().attr("name"),products_input:e.find("input").first().attr("name")};return a.post(ajaxurl,f,function(b){a(b).insertBefore(e),c.updateLayerNames(d)}),!1},ENDA_BUNDLERATE.removeLayer=function(a){var b=a.parents("table").first();return this.updateStartCount(a),a.parents("tr").first().remove(),this.updateLayerNames(b),!1},ENDA_BUNDLERATE.disableAddLayerButton=function(a){var b=a.find("tr.rate_row input").first().val();b&&"0"!==b&&""!==b||a.find(".add_layer").first().attr("disabled",!0)},ENDA_BUNDLERATE.addConfiguration=function(b){var c=a("#enda-bundle-rate-configurations .enda-configuration"),d={action:"get_new_configuration_layer",index:c.length};return a.post(ajaxurl,d,function(b){a(b).insertAfter(c.last()),ENDA_BUNDLERATE.init()}),!1},ENDA_BUNDLERATE.removeConfiguration=function(a){return a.parents(".enda-configuration").remove(),!1},ENDA_BUNDLERATE.init=function(){var b=this;a(".shipping_destination .destination").on("change",function(){b.toggleSpecificCountries(a(this))}).change(),a("select.chosen_select").select2(),a(".shipping_rates table").each(function(){b.disableAddLayerButton(a(this))})},a(document).ready(function(){var b=ENDA_BUNDLERATE;b.init(),a("#enda-bundle-rate-configurations").on("click",".add_layer",function(){return b.addLayer(a(this))}).on("click",".remove_bundle_layer",function(){return b.removeLayer(a(this))}).on("change","input.bundle_rate_products",function(){b.updateStartCount(a(this)),a(this).val()&&"0"!==a(this).val()&&""!==a(this).val()?a(this).parents("table").first().find(".add_layer").first().attr("disabled",!1):a(this).parents("table").first().find(".add_layer").first().attr("disabled",!0)}).on("click",".add_bundle_configuration",function(){return b.addConfiguration(a(this))}).on("click",".remove_bundle_configuration",function(){return b.removeConfiguration(a(this))})})}(jQuery);